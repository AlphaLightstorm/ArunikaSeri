<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Link Hub</title>
  <meta name="description" content="Professional link hub for creators" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6fbff;
      --card:#ffffff;
      --muted:#6b7b8c;
      --accent:#1e90ff;
      --accent-2:#00b4ff;
      --glass: rgba(30,144,255,0.06);
      --radius:18px;
      --max-width:880px;
      --shadow: 0 18px 48px rgba(20,40,80,0.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,#f8fbff 0%,#eef7ff 100%);
      color:#0b1b2b;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
    }

    .wrap{
      width:100%;
      max-width:var(--max-width);
      background:var(--card);
      border-radius:20px;
      padding:24px;
      box-shadow:var(--shadow);
      border:1px solid rgba(15,30,60,0.04);
    }

    header{
      display:flex;
      gap:18px;
      align-items:center;
      margin-bottom:20px;
    }
    .avatar{
      width:112px;
      height:112px;
      border-radius:16px;
      overflow:hidden;
      flex:0 0 112px;
      border:1px solid rgba(30,144,255,0.12);
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:32px;
      color:white;
      position:relative;
    }
    .avatar input[type="file"]{ display:none }
    .avatar .edit{
      position:absolute;
      right:8px;
      bottom:8px;
      background:rgba(255,255,255,0.95);
      color:var(--accent);
      border-radius:10px;
      padding:6px 8px;
      font-size:13px;
      cursor:pointer;
      border:1px solid rgba(15,30,60,0.04);
    }

    .profile{
      flex:1;
      min-width:0;
    }
    .name{
      font-size:22px;
      font-weight:700;
      margin-bottom:6px;
    }
    .tagline{
      color:var(--muted);
      font-size:14px;
      margin-bottom:8px;
    }
    .profile .desc{
      color:var(--muted);
      font-size:14px;
      margin-top:6px;
    }

    .controls{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .btn{
      background:transparent;
      border:1px solid rgba(15,30,60,0.06);
      color:var(--muted);
      padding:10px 14px;
      border-radius:12px;
      font-size:14px;
      cursor:pointer;
      display:inline-flex;
      gap:10px;
      align-items:center;
    }
    .btn.primary{
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:white;
      border:none;
      font-weight:700;
    }

    main{
      display:grid;
      gap:16px;
      margin-top:8px;
      max-height:72vh;
      overflow:auto;
      padding-right:6px;
    }

    .card{
      display:flex;
      align-items:center;
      gap:16px;
      padding:18px;
      border-radius:14px;
      background:linear-gradient(180deg, rgba(240,248,255,0.95), rgba(255,255,255,0.98));
      border:1px solid rgba(15,30,60,0.04);
      transition:transform .12s ease, box-shadow .12s ease;
      cursor:pointer;
    }
    .card:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(20,40,80,0.06) }
    .card .thumb{
      width:96px;
      height:96px;
      border-radius:12px;
      background:var(--glass);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:var(--accent);
      flex:0 0 96px;
      overflow:hidden;
      position:relative;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block }
    .thumb .placeholder{ font-size:22px; color:var(--accent) }

    .card .meta{
      flex:1;
      min-width:0;
    }
    .label{
      font-weight:800;
      font-size:18px;
      margin-bottom:6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .url{
      color:var(--muted);
      font-size:14px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .right{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .icon{
      width:48px;
      height:48px;
      border-radius:12px;
      display:inline-grid;
      place-items:center;
      background:rgba(15,30,60,0.03);
      color:var(--muted);
      font-size:16px;
      cursor:pointer;
    }
    .counter{
      font-size:13px;
      color:var(--muted);
      background:rgba(15,30,60,0.03);
      padding:8px 10px;
      border-radius:999px;
    }

    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:60;
      background:linear-gradient(180deg, rgba(10,20,30,0.35), rgba(10,20,30,0.35));
      padding:20px;
    }
    .modal.open{ display:flex }
    .panel{
      width:100%;
      max-width:720px;
      background:var(--card);
      border-radius:14px;
      padding:18px;
      border:1px solid rgba(15,30,60,0.04);
      box-shadow:0 12px 30px rgba(10,20,30,0.08);
    }
    .field{ display:flex; flex-direction:column; gap:8px; margin-bottom:12px }
    label{ color:var(--muted); font-size:13px }
    input[type="text"], textarea{
      padding:12px 14px;
      border-radius:10px;
      border:1px solid rgba(15,30,60,0.06);
      background:transparent;
      color:inherit;
      outline:none;
      font-size:15px;
    }
    textarea{ min-height:80px; resize:vertical; }
    .row{ display:flex; gap:10px; justify-content:flex-end; margin-top:6px }
    .small{ font-size:13px; color:var(--muted) }

    footer{
      margin-top:16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      color:var(--muted);
      font-size:13px;
    }

    @media (max-width:720px){
      .avatar{ width:88px; height:88px; flex:0 0 88px }
      .card .thumb{ width:76px; height:76px; flex:0 0 76px }
      .label{ font-size:16px }
    }
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="Link hub">
    <header>
      <label class="avatar" id="avatar" title="Upload profile picture">
        <img id="avatarImg" alt="Profile" style="width:100%;height:100%;object-fit:cover;display:none" />
        <div id="avatarInitials">AL</div>
        <input id="avatarFile" type="file" accept="image/*" aria-label="Upload profile picture" />
        <div class="edit" id="avatarEdit">Edit</div>
      </label>

      <div class="profile">
        <div class="name" id="displayName">Your Name</div>
        <div class="tagline" id="tagline">Creator ‚Ä¢ TikTok Monetization</div>
        <div class="desc" id="description">Short description or call to action goes here.</div>
      </div>

      <div class="controls">
        <button class="btn" id="importBtn" title="Import links">Import</button>
        <button class="btn" id="exportBtn" title="Export links">Export</button>
        <button class="btn" id="addBtn" title="Add link">Add Link</button>
        <button class="btn primary" id="editProfile">Edit Profile</button>
      </div>
    </header>

    <main id="list" aria-live="polite"></main>

    <footer>
      <div class="small">Light blue theme ‚Ä¢ Mobile-first</div>
      <div class="small">Local clicks tracked ‚Ä¢ Optional public sync available</div>
    </footer>
  </div>

  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="panel" role="document">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong id="modalTitle">Edit Link</strong>
        <button class="btn" id="closeModal">Close</button>
      </div>

      <div class="field">
        <label for="labelInput">Button Label</label>
        <input id="labelInput" type="text" placeholder="e.g., Support Me" />
      </div>

      <div class="field">
        <label for="urlInput">URL</label>
        <input id="urlInput" type="text" placeholder="https://example.com" />
      </div>

      <div class="field">
        <label for="thumbInput">Thumbnail Image</label>
        <input id="thumbInput" type="file" accept="image/*" />
        <div id="thumbPreview" style="margin-top:8px"></div>
      </div>

      <div class="row">
        <button class="btn" id="deleteLink">Delete</button>
        <button class="btn primary" id="saveLink">Save</button>
      </div>
    </div>
  </div>

  <script>
    const DEFAULT = [
      { id: 'l1', label: 'TikTok', url: 'https://www.tiktok.com/@yourhandle', thumb: '', clicks: 0 },
      { id: 'l2', label: 'YouTube', url: 'https://youtube.com', thumb: '', clicks: 0 },
      { id: 'l3', label: 'Affiliate', url: 'https://example.com', thumb: '', clicks: 0 }
    ];

    const STORAGE_KEY = 'linkhub_v3';
    const PROFILE_KEY = 'linkhub_profile_v3';

    const listEl = document.getElementById('list');
    const modal = document.getElementById('modal');
    const labelInput = document.getElementById('labelInput');
    const urlInput = document.getElementById('urlInput');
    const thumbInput = document.getElementById('thumbInput');
    const thumbPreview = document.getElementById('thumbPreview');
    const modalTitle = document.getElementById('modalTitle');
    const saveLinkBtn = document.getElementById('saveLink');
    const deleteLinkBtn = document.getElementById('deleteLink');
    const closeModalBtn = document.getElementById('closeModal');
    const exportBtn = document.getElementById('exportBtn');
    const importBtn = document.getElementById('importBtn');
    const editProfileBtn = document.getElementById('editProfile');
    const addBtn = document.getElementById('addBtn');

    const displayName = document.getElementById('displayName');
    const tagline = document.getElementById('tagline');
    const description = document.getElementById('description');
    const avatarFile = document.getElementById('avatarFile');
    const avatarImg = document.getElementById('avatarImg');
    const avatarInitials = document.getElementById('avatarInitials');
    const avatarEdit = document.getElementById('avatarEdit');

    let links = loadLinks();
    let currentEditId = null;
    let currentThumbData = '';

    function loadLinks(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(raw) return JSON.parse(raw);
      }catch(e){}
      localStorage.setItem(STORAGE_KEY, JSON.stringify(DEFAULT));
      return JSON.parse(JSON.stringify(DEFAULT));
    }
    function saveLinks(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(links));
    }

    function loadProfile(){
      try{ return JSON.parse(localStorage.getItem(PROFILE_KEY) || '{}'); }catch(e){ return {}; }
    }
    function saveProfile(p){
      localStorage.setItem(PROFILE_KEY, JSON.stringify(p));
    }
    function loadProfileToUI(){
      const p = loadProfile();
      if(p.name) displayName.textContent = p.name;
      if(p.tag) tagline.textContent = p.tag;
      if(p.desc) description.textContent = p.desc;
      if(p.avatarData){
        avatarImg.src = p.avatarData;
        avatarImg.style.display = 'block';
        avatarInitials.style.display = 'none';
      } else {
        avatarImg.style.display = 'none';
        avatarInitials.style.display = p.initials || 'AL';
      }
    }

    function render(){
      listEl.innerHTML = '';
      links.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.id = item.id;

        const thumbHtml = item.thumb
          ? `<div class="thumb"><img src="${escapeHtml(item.thumb)}" alt="${escapeHtml(item.label)}" loading="lazy" /></div>`
          : `<div class="thumb"><div class="placeholder">${escapeHtml(item.label.slice(0,2).toUpperCase())}</div></div>`;

        card.innerHTML = `
          ${thumbHtml}
          <div class="meta">
            <div class="label">${escapeHtml(item.label)}</div>
            <div class="url">${escapeHtml(item.url)}</div>
          </div>
          <div class="right">
            <div class="counter" title="Clicks">${item.clicks || 0}</div>
            <div class="icon" data-action="edit" title="Edit">‚úèÔ∏è</div>
            <div class="icon" data-action="copy" title="Copy URL">üìã</div>
          </div>
        `;

        card.addEventListener('click', (e) => {
          const action = e.target.closest('[data-action]')?.dataset.action;
          const id = card.dataset.id;
          if(action === 'edit'){ openEditor(id); e.stopPropagation(); return; }
          if(action === 'copy'){ copyUrl(id); e.stopPropagation(); return; }
          const link = links.find(l => l.id === id);
          if(link && link.url){
            window.open(link.url, '_blank', 'noopener');
            incrementClick(id);
          }
        });

        listEl.appendChild(card);
      });
    }

    function openEditor(id){
      currentEditId = id;
      const item = links.find(l => l.id === id) || {};
      modalTitle.textContent = id ? 'Edit Link' : 'New Link';
      labelInput.value = item.label || '';
      urlInput.value = item.url || '';
      currentThumbData = item.thumb || '';
      renderThumbPreview(currentThumbData);
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      labelInput.focus();
    }
    function closeEditor(){
      currentEditId = null;
      currentThumbData = '';
      thumbInput.value = '';
      thumbPreview.innerHTML = '';
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden','true');
    }

    saveLinkBtn.addEventListener('click', async () => {
      const label = labelInput.value.trim() || 'Untitled';
      let url = urlInput.value.trim();
      if(url && !/^https?:\/\//i.test(url)) url = 'https://' + url;
      if(currentEditId){
        const idx = links.findIndex(l => l.id === currentEditId);
        if(idx > -1){
          links[idx].label = label;
          links[idx].url = url;
          links[idx].thumb = currentThumbData || '';
          saveLinks();
          render();
        }
      } else {
        const id = 'l' + Date.now();
        links.unshift({ id, label, url, thumb: currentThumbData || '', clicks: 0 });
        saveLinks();
        render();
      }
      closeEditor();
    });

    deleteLinkBtn.addEventListener('click', () => {
      if(!currentEditId) return;
      links = links.filter(l => l.id !== currentEditId);
      saveLinks();
      render();
      closeEditor();
    });

    closeModalBtn.addEventListener('click', closeEditor);
    modal.addEventListener('click', (e) => { if(e.target === modal) closeEditor(); });

    function incrementClick(id){
      const idx = links.findIndex(l => l.id === id);
      if(idx > -1){
        links[idx].clicks = (links[idx].clicks || 0) + 1;
        saveLinks();
        render();
      }
    }
    function copyUrl(id){
      const item = links.find(l => l.id === id);
      if(!item) return;
      navigator.clipboard?.writeText(item.url || '')?.then(() => {
        const el = document.querySelector(`.card[data-id="${id}"] .icon[data-action="copy"]`);
        if(el){ el.textContent = '‚úÖ'; setTimeout(()=>el.textContent='üìã',900); }
      });
    }

    exportBtn.addEventListener('click', () => {
      const payload = { profile: loadProfile(), links };
      navigator.clipboard?.writeText(JSON.stringify(payload, null, 2));
      exportBtn.textContent = 'Copied';
      setTimeout(()=>exportBtn.textContent='Export',1200);
    });

    importBtn.addEventListener('click', async () => {
      const raw = prompt('Paste exported JSON here');
      if(!raw) return;
      try{
        const parsed = JSON.parse(raw);
        if(parsed.profile) saveProfile(parsed.profile);
        if(Array.isArray(parsed.links)) links = parsed.links;
        saveLinks();
        render();
        loadProfileToUI();
        importBtn.textContent = 'Imported';
        setTimeout(()=>importBtn.textContent='Import',1200);
      }catch(e){
        alert('Invalid JSON');
      }
    });

    addBtn.addEventListener('click', () => {
      currentEditId = null;
      modalTitle.textContent = 'New Link';
      labelInput.value = '';
      urlInput.value = '';
      currentThumbData = '';
      renderThumbPreview('');
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      labelInput.focus();
    });

    editProfileBtn.addEventListener('click', () => {
      const name = prompt('Display name', displayName.textContent) || displayName.textContent;
      const tag = prompt('Tagline', tagline.textContent) || tagline.textContent;
      const desc = prompt('Short description', description.textContent) || description.textContent;
      const initials = name.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase();
      displayName.textContent = name;
      tagline.textContent = tag;
      description.textContent = desc;
      avatarInitials.textContent = initials;
      saveProfile({ name, tag, desc, initials, avatarData: loadProfile().avatarData || '' });
    });

    avatarEdit.addEventListener('click', () => avatarFile.click());
    avatarFile.addEventListener('change', async (e) => {
      const f = e.target.files?.[0];
      if(!f) return;
      const data = await fileToDataUrl(f);
      avatarImg.src = data;
      avatarImg.style.display = 'block';
      avatarInitials.style.display = 'none';
      const p = loadProfile();
      p.avatarData = data;
      saveProfile(p);
    });

    thumbInput.addEventListener('change', async (e) => {
      const f = e.target.files?.[0];
      if(!f) return;
      const data = await fileToDataUrl(f);
      currentThumbData = data;
      renderThumbPreview(data);
    });

    function renderThumbPreview(data){
      if(!data){
        thumbPreview.innerHTML = '<div style="color:var(--muted);font-size:13px">No thumbnail selected</div>';
        return;
      }
      thumbPreview.innerHTML = `<img src="${escapeHtml(data)}" style="width:160px;height:100px;object-fit:cover;border-radius:8px;border:1px solid rgba(15,30,60,0.04)" alt="thumb preview" loading="lazy" />`;
    }

    function fileToDataUrl(file){
      return new Promise((res, rej) => {
        const r = new FileReader();
        r.onload = () => res(r.result);
        r.onerror = rej;
        r.readAsDataURL(file);
      });
    }
    function escapeHtml(s){ return String(s || '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    loadProfileToUI();
    render();

    document.addEventListener('keydown', (e) => {
      if(e.key.toLowerCase() === 'n' && !modal.classList.contains('open')){
        addBtn.click();
      }
      if(e.key === 'Escape' && modal.classList.contains('open')) closeEditor();
    });

    /* Optional Firebase integration
       To enable public persistence across visitors use Firestore and Storage.
       Steps:
       1) Create Firebase project and enable Firestore and Storage.
       2) Add a Web App and copy the config.
       3) Paste config into firebaseConfig below and include Firebase SDK scripts.
       4) Implement syncToServer and loadFromServer to push and pull profile and links.
       5) Secure rules so only you can write.

       Example placeholder code:
    */

    /*
    // Paste Firebase SDK scripts in head and uncomment below after adding config
    const firebaseConfig = {
      apiKey: "PASTE_API_KEY",
      authDomain: "PASTE_AUTH_DOMAIN",
      projectId: "PASTE_PROJECT_ID",
      storageBucket: "PASTE_STORAGE_BUCKET",
      messagingSenderId: "PASTE_SENDER_ID",
      appId: "PASTE_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    async function syncToServer(){
      await db.collection('linkhubs').doc('PUBLIC_ID').set({ profile: loadProfile(), links });
    }

    async function loadFromServer(){
      const doc = await db.collection('linkhubs').doc('PUBLIC_ID').get();
      if(doc.exists){
        const data = doc.data();
        if(data.profile) saveProfile(data.profile);
        if(Array.isArray(data.links)) { links = data.links; saveLinks(); render(); }
      }
    }
    */
  </script>
</body>
</html>
